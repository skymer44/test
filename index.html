<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    
    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#f7fafc">
    <meta name="background-color" content="#f7fafc">
    
    <!-- iOS Specific Meta Tags for PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Musical 2026">
    <link rel="apple-touch-icon" href="icons/icon-152x152.svg">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152x152.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-192x192.svg">
    <link rel="apple-touch-icon" sizes="167x167" href="icons/icon-192x192.svg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="icons/icon-192x192.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32x32.svg">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/icon-16x16.svg">
    
    <!-- Cache Busting - Version v20250707_e2cbdb2a -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="version" content="v20250708_a280087e">
    <meta name="build-time" content="2025-07-08T12:14:00.000Z">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiche Musicien</title>
    <!-- CSS critique pour éviter le flash des liens d'achat -->
    <style>
        .links a[title="Lien d'achat"] {
            display: none !important;
        }
        /* Test modification mineure v2 */
    </style>
    <link rel="stylesheet" href="styles.css?v=v20250708_a280087e">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Fiche Musicien</h1>
            <div id="site-stats" class="site-statistics">
                <!-- Les statistiques seront mises à jour automatiquement par JavaScript -->
            </div>
        </div>
    </header>

    <!-- Navigation principale = Header unifié (desktop) -->
    <nav class="tab-navigation">
        <div class="tab-container">
            <h1 class="tab-title">Fiche Musicien</h1>
            <div class="tab-buttons">
                <button class="tab-button active" data-tab="prochains-evenements">
                    <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="3" y="4" width="18" height="15" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M16 2v4M8 2v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 10h18" stroke="currentColor" stroke-width="2"/>
                        <circle cx="8" cy="14" r="1.5" fill="currentColor"/>
                        <circle cx="16" cy="14" r="1.5" fill="currentColor"/>
                    </svg>
                    Prochains événements à venir
                </button>
                <button class="tab-button" data-tab="programmes">
                    <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="3" y="4" width="18" height="15" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M7 8h10M7 12h8M7 16h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="17" cy="12" r="1.5" fill="currentColor"/>
                        <path d="M16 10v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    Programme musical
                </button>
                <button class="tab-button" data-tab="partitions">
                    <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" stroke="currentColor" stroke-width="2" stroke-linejoin="round" fill="none"/>
                        <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M8 13h8M8 17h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Partitions
                </button>
            </div>
            <div id="site-stats" class="site-statistics">
                <!-- Les statistiques seront mises à jour automatiquement par JavaScript -->
            </div>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Rechercher une pièce, un compositeur..." class="search-input">
            </div>
        </div>
    </nav>

    <!-- Navigation mobile en bas -->
    <nav class="mobile-bottom-nav">
        <div class="mobile-nav-item active" data-tab="prochains-evenements">
            <div class="mobile-nav-icon">
                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="4" width="18" height="15" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
                    <path d="M16 2v4M8 2v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M3 10h18" stroke="currentColor" stroke-width="2"/>
                    <circle cx="8" cy="14" r="1.5" fill="currentColor"/>
                    <circle cx="16" cy="14" r="1.5" fill="currentColor"/>
                </svg>
            </div>
            <div class="mobile-nav-label">Événements</div>
        </div>
        <div class="mobile-nav-item" data-tab="programmes">
            <div class="mobile-nav-icon">
                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="4" width="18" height="15" rx="2" stroke="currentColor" stroke-width="2" fill="none"/>
                    <path d="M7 8h10M7 12h8M7 16h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="17" cy="12" r="1.5" fill="currentColor"/>
                    <path d="M16 10v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
            </div>
            <div class="mobile-nav-label">Programme</div>
        </div>
        <div class="mobile-nav-item" data-tab="partitions">
            <div class="mobile-nav-icon">
                <svg class="icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" stroke="currentColor" stroke-width="2" stroke-linejoin="round" fill="none"/>
                    <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8 13h8M8 17h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </div>
            <div class="mobile-nav-label">Partitions</div>
        </div>
    </nav>

    <main>
        <!-- Section Prochains événements à venir -->
        <div id="prochains-evenements" class="tab-content active">
            <section class="next-events-section">
                <!-- Événement principal suivant -->
                <div class="main-next-event" id="main-next-event">
                    <div class="loading-placeholder">
                        <p>Chargement des événements...</p>
                    </div>
                </div>
                
                <!-- Aperçu des événements suivants -->
                <div class="upcoming-events-preview">
                    <h3>Événements suivants</h3>
                    <div class="upcoming-events-list" id="upcoming-events-list">
                        <div class="loading-placeholder">
                            <p>Chargement...</p>
                        </div>
                    </div>
                    
                    <!-- Zone pour charger plus d'événements automatiquement -->
                    <div id="events-load-more-trigger" class="events-load-more-trigger"></div>
                </div>
            </section>
        </div>

        <!-- Section Programmes -->
        <div id="programmes" class="tab-content">
            <!-- ZONE NOTION - Contenu injecté automatiquement -->
            <div id="programmes-content">
                <!-- Le contenu Notion sera injecté ici par programme-loader.js -->
            </div>
            <!-- FIN ZONE NOTION -->
        </div>

        <!-- Section Partitions -->
        <div id="partitions" class="tab-content">
            <section class="partitions-section-clean">
                <div class="partitions-content-clean">
                    
                    <!-- Message d'avertissement principal -->
                    <div class="warning-section">
                        <div class="warning-header">
                            <span class="warning-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2L1 21h22L12 2zm0 3.99L19.53 19H4.47L12 5.99zM11 16h2v2h-2zm0-6h2v4h-2z" fill="currentColor"/>
                                </svg>
                            </span>
                            <h3>Règles d'impression des partitions</h3>
                        </div>
                        <div class="warning-text">
                            <p>ATTENTION, vous ne devez pas imprimer les partitions en plus d'exemplaires qu'indiqué en bas de page (normalement, aucun souci, vous avez au moins un exemplaire chacun).</p>
                        </div>
                    </div>
                    
                    <!-- Exemples pratiques -->
                    <div class="examples-section-clean">
                        <h4>Exemples pratiques :</h4>
                        
                        <div class="example-item">
                            <p>• Si je suis <strong>trompette 1</strong> et que nous sommes <strong>deux à jouer cette partie</strong>, je lis en bas de page : <strong>« 2 copies purchased »</strong> → je ne peux en imprimer <strong>qu'une seule</strong> pour moi</p>
                        </div>
                        
                        <div class="example-item">
                            <p>• Mais s'il est écrit : <strong>« 6 copies purchased »</strong> → vous pouvez en imprimer <strong>3</strong> (une pour l'orchestre, une pour chez vous sur votre pupitre et une pour allumer le barbecue)</p>
                        </div>
                    </div>
                    
                    <!-- Accès aux partitions -->
                    <div class="access-section">
                        <div class="access-card">
                            <div class="access-info">
                                <span class="folder-icon">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z" fill="currentColor"/>
                                    </svg>
                                </span>
                                <div class="access-text">
                                    <h4>Dossier des partitions</h4>
                                    <p>Accédez à toutes les partitions du programme 2026</p>
                                </div>
                            </div>
                            <a href="https://drive.google.com/drive/folders/1CXdB2LQvuqJ_F6WX-CYrf9DtB3hJgppH" target="_blank" class="access-button">
                                Ouvrir le Drive →
                            </a>
                        </div>
                    </div>
                    
                </div>
            </section>
        </div>
    </main>

    <!-- Modale vidéo YouTube -->
    <div id="video-modal" class="video-modal">
        <div class="video-modal-wrapper">
            <div class="video-controls">
                <button id="audio-mode-btn" class="control-btn" title="Mode audio uniquement">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 1c-4.97 0-9 4.03-9 9v7c0 1.66 1.34 3 3 3h3v-8H5v-2c0-3.87 3.13-7 7-7s7 3.13 7 7v2h-4v8h3c1.66 0 3-1.34 3-3v-7c0-4.97-4.03-9-9-9z" fill="currentColor"/>
                    </svg>
                </button>
                <button id="close-modal-btn" class="control-btn" title="Fermer">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
            <div class="video-modal-content">
                <div class="video-container">
                    <iframe id="youtube-player" 
                            width="100%" 
                            height="100%" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Mini-lecteur audio en bas -->
    <div id="audio-player" class="audio-player">
        <div class="audio-player-content">
            <div class="audio-info">
                <span id="audio-title">Titre de la pièce</span>
                <span id="audio-title-floating" style="display: none;">Titre de la pièce</span>
            </div>
            <div class="audio-controls">
                <button id="show-video-btn" class="audio-control-btn" title="Afficher la vidéo">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 5v14l11-7z" fill="currentColor"/>
                    </svg>
                </button>
                <button id="stop-audio-btn" class="audio-control-btn" title="Arrêter">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 6h12v12H6z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Bibliothèque jsPDF pour la génération de PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Scripts de diagnostic temporairement désactivés -->
    <!-- <script src="diagnostic-simple.js"></script>
    <script src="debug-triggerTabAnimations.js"></script> -->
    <!-- <script src="test-real-time.js"></script>
    <script src="diagnostic-scroll.js"></script>
    <script src="test-final.js"></script> -->
    
    <!-- Script original pour les fonctionnalités de base -->
    <script src="script.js?v=v20250708_a280087e"></script>
    
    <!-- FIX ANIMATION PROGRAMMES -->
    <script src="fix-animations.js"></script>
    
    <!-- Chargeur dynamique de contenu Notion -->
    <script src="scripts/programme-loader.js?v=v20250708_DEBUG001"></script>
</body>
</html>
